  0%|                                                                        | 15/1000000 [00:01<30:54:46,  8.99it/s]
value_s_pi -0.026220152154564857
value_s_in -0.042533375322818756
value_s_pi 0.06577911972999573
value_s_in 0.04282405227422714
value_s_pi 0.15474222600460052
value_s_in 0.11813893169164658
value_s_pi 0.2421545386314392
value_s_in 0.20209458470344543
value_s_pi 0.32640013098716736
value_s_in 0.2861443758010864
value_s_pi 0.4198882281780243
value_s_in 0.37332606315612793
value_s_pi 0.5070796608924866
value_s_in 0.44838476181030273
value_s_pi 0.5822033882141113
value_s_in 0.5157408118247986
value_s_pi 0.689034104347229
value_s_in 0.5984544157981873
value_s_pi 0.7624472379684448
value_s_in 0.6808257699012756
value_s_pi 0.8546352386474609
value_s_in 0.7704434990882874
value_s_pi 0.9611524343490601
value_s_in 0.8599430322647095
value_s_pi 1.0328727960586548
value_s_in 0.9436569213867188
value_s_pi 1.1379872560501099
value_s_in 1.0354793071746826
value_s_pi 1.20986008644104
value_s_in 1.140835165977478
value_s_pi 1.3535220623016357
value_s_in 1.2235264778137207
value_s_pi 1.4165229797363281
value_s_in 1.3184638023376465
value_s_pi 1.5399750471115112
value_s_in 1.44356107711792
value_s_pi 1.6532244682312012
value_s_in 1.5086265802383423
value_s_pi 1.7469961643218994
value_s_in 1.6030187606811523
value_s_pi 1.860590934753418
value_s_in 1.7483744621276855
value_s_pi 1.960615634918213
value_s_in 1.8025344610214233
value_s_pi 2.1477694511413574
value_s_in 1.957854986190796
value_s_pi 2.1820144653320312
value_s_in 2.012953758239746
value_s_pi 2.336073875427246
value_s_in 2.157815933227539
value_s_pi 2.440417766571045
value_s_in 2.278634548187256
value_s_pi 2.5433197021484375
value_s_in 2.4264962673187256
value_s_pi 2.673668146133423
value_s_in 2.4847512245178223
value_s_pi 2.7841200828552246
value_s_in 2.643815040588379
value_s_pi 2.8290975093841553
value_s_in 2.705329656600952
value_s_pi 2.9742074012756348
value_s_in 2.813760757446289
value_s_pi 3.1306073665618896
value_s_in 2.928124189376831
value_s_pi 3.2351222038269043
value_s_in 3.008944511413574
value_s_pi 3.370195150375366
value_s_in 3.1007943153381348
value_s_pi 3.447904348373413
value_s_in 3.2219326496124268
value_s_pi 3.51686954498291
value_s_in 3.3578505516052246
value_s_pi 3.645242214202881
value_s_in 3.5365920066833496
value_s_pi 3.7257461547851562
value_s_in 3.527742862701416
value_s_pi 3.837838649749756
value_s_in 3.6796960830688477
value_s_pi 3.911087989807129
value_s_in 3.7621655464172363
value_s_pi 4.079497337341309
value_s_in 3.885765314102173
value_s_pi 4.1591339111328125
value_s_in 4.005405426025391
value_s_pi 4.220516204833984
value_s_in 4.05342435836792
value_s_pi 4.2474565505981445
value_s_in 4.112271308898926
value_s_pi 4.4031267166137695
value_s_in 4.148649215698242
value_s_pi 4.487006187438965
value_s_in 4.23099422454834
value_s_pi 4.466695785522461
value_s_in 4.421795845031738
value_s_pi 4.518483638763428
value_s_in 4.429160118103027
value_s_pi 4.520529747009277
value_s_in 4.436394691467285
value_s_pi 4.630888938903809
value_s_in 4.484031677246094
value_s_pi 4.555290699005127
value_s_in 4.434678554534912
value_s_pi 4.616198539733887
value_s_in 4.585198402404785
value_s_pi 4.769449234008789
value_s_in 4.645352363586426
value_s_pi 4.708880424499512
value_s_in 4.574582576751709
value_s_pi 4.783668518066406
value_s_in 4.654579162597656
Traceback (most recent call last):
  File "/home/autolab/wander/Diffusion_OOD_Detection/3_pos_ood_compensation/main.py", line 276, in <module>
    agent.train(args.batch_size)
  File "/home/autolab/wander/Diffusion_OOD_Detection/3_pos_ood_compensation/diffusion_pos_ood_compensation.py", line 308, in train
    critic_loss, reg_loss, vc_loss, current_Q, qmin, positive_ood_action_mask, negative_ood_action_mask,  ood_action_mask = self.critic_loss(state, action, reward, next_state, not_done)
  File "/home/autolab/wander/Diffusion_OOD_Detection/3_pos_ood_compensation/diffusion_pos_ood_compensation.py", line 250, in critic_loss
    best_id_action, best_id_q = self.select_best_id_action(state)  # [B, action_dim], [B]
  File "/home/autolab/wander/Diffusion_OOD_Detection/3_pos_ood_compensation/diffusion_pos_ood_compensation.py", line 164, in select_best_id_action
    all_actions = self.diffusion_model.sample(
  File "../diffusion/karras.py", line 212, in sample
    c_skip, c_out, c_in = [append_dims(x, 2) for x in self.get_diffusion_scalings(sigma)]
  File "../diffusion/karras.py", line 47, in get_diffusion_scalings
    c_in = 1 / (sigma ** 2 + self.sigma_data ** 2) ** 0.5
  File "/home/autolab/anaconda3/envs/svr/lib/python3.9/site-packages/torch/_tensor.py", line 39, in wrapped
    return f(*args, **kwargs)
KeyboardInterrupt
